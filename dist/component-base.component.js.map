{"version":3,"sources":["../src/app/component-base.component.ts"],"names":[],"mappings":"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","file":"component-base.component.js","sourceRoot":"","sourcesContent":["import { Router } from '@angular/router';\r\nimport { LoggingService } from 'buildmotion-logging/logging.service';\r\n\r\nimport { MessageType } from 'angular-rules-engine/service/index';\r\nimport { ServiceContext } from 'angular-rules-engine/service/index';\r\nimport { ServiceMessage } from 'angular-rules-engine/service/index';\r\nimport { ErrorResponse } from 'buildmotion-foundation/models/error-response.model';\r\nimport { Severity } from 'buildmotion-logging/severity.enum';\r\nimport { AlertNotification } from 'buildmotion-alert/alert/models/alert-notification.model';\r\nimport { AlertTypes } from 'buildmotion-alert/alert/models/alert-types.constants';\r\n\r\nexport class ComponentBase {\r\n    componentName: string;\r\n    alertNotification: AlertNotification;\r\n\r\n    constructor(\r\n        componentName: string,\r\n        public loggingService: LoggingService,\r\n        public router: Router\r\n    ) {\r\n        this.componentName = componentName;\r\n        this.alertNotification = new AlertNotification('', '');\r\n    }\r\n\r\n    /**\r\n     * Use to create a simple [ErrorResponse] with the specified message.\r\n     * @param message The message to display to the user.\r\n     */\r\n    createErrorResponse(message: string): ErrorResponse {\r\n        let response: ErrorResponse = new ErrorResponse();\r\n        response.Message = message;\r\n        return response;\r\n    }\r\n\r\n    /**\r\n     * for development\r\n    */\r\n    handleError(error): void {\r\n        const message = new ServiceMessage(error.name, error.message)\r\n            .WithDisplayToUser(true)\r\n            .WithMessageType(MessageType.Error)\r\n            .WithSource(this.componentName);\r\n\r\n        this.loggingService.log(this.componentName, Severity.Error, message.toString());\r\n    }\r\n\r\n    /**\r\n     * Use to handle service errors. These are error response [See: ErrorResponse] from \r\n     * the application business layers (Action(s) or Http) that will bubble up to the \r\n     * caller (i.e., a component) in a specified format:\r\n     *\r\n     * IsSuccess: boolean = false; // default for ErrorResponse\r\n     * Message: string;\r\n     * Errors: Array<ServiceError> = new Array<ServiceError>();\r\n     * Exception: any;\r\n     */\r\n    handleServiceErrors(errorResponse: ErrorResponse, serviceContext?: ServiceContext) {\r\n        if (serviceContext && serviceContext.hasErrors()) {\r\n            // retrieving error messages from the ServiceContext/ValidationContext;\r\n            const messages = this.retrieveServiceContextErrorMessages(serviceContext);\r\n            this.alertNotification = new AlertNotification('Errors', errorResponse.Message, messages, AlertTypes.Warning);\r\n        } else {\r\n                if (errorResponse && errorResponse.Message) {\r\n                const errors = this.retrieveResponseErrorMessages(errorResponse);\r\n                this.alertNotification = new AlertNotification('Error', errorResponse.Message, errors, AlertTypes.Warning);\r\n                this.loggingService.log(this.componentName, Severity.Error, `Error: ${errorResponse.Message}`);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Use to retrieve the error messages from the specified [ServiceContext]. \r\n     *\r\n     * @parm: serviceContext: A context object containing messages for the specified request.\r\n     */\r\n    retrieveServiceContextErrorMessages(serviceContext: ServiceContext): Array<string> {\r\n        const messages = Array<string>();\r\n        serviceContext.Messages.forEach(e => {\r\n            if (e.MessageType === MessageType.Error && e.DisplayToUser) {\r\n                messages.push(e.Message);\r\n            }\r\n        });\r\n\r\n        return messages;\r\n    }\r\n\r\n    /**\r\n     * Use to retrieve the error messages from the specified Web API response. \r\n     */\r\n    retrieveResponseErrorMessages(errorResponse: ErrorResponse) {\r\n        const errors = new Array<string>();\r\n        if (errorResponse && errorResponse.Errors) {\r\n            errorResponse.Errors.forEach(e => {\r\n                if (e.DisplayToUser) {\r\n                    errors.push(e.Message);\r\n                }\r\n            });\r\n        }\r\n        return errors;\r\n    }\r\n\r\n    /**\r\n     * Use to reset the [AlertNotification] to the initial state. Removes\r\n     * existing messages and hides the AlertComponent.\r\n     */\r\n    resetAlertNotifications() {\r\n        this.alertNotification = new AlertNotification('', '');\r\n    }\r\n\r\n    /**\r\n     * Use to navigate to the specified route.\r\n     * @parm routeName: The name of the target route.\r\n     */\r\n    public routeTo(routeName: string) {\r\n        try {\r\n            this.router.navigate([routeName]);\r\n        } catch (error) {\r\n            this.loggingService.log(this.componentName, Severity.Error, `Error while attempting to navigate to [${routeName}] route from ${this.componentName}. Error: ${error.toString()}`);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Use to retrieve and show any response error messages.\r\n     */\r\n    showResponseErrors(response: ErrorResponse) {\r\n        // let messages = this.retrieveResponseErrorMessages(response);\r\n        // this.alertNotification = new AlertNotification('Errors', response.Message, messages, AlertTypes.Warning);\r\n        this.handleServiceErrors(response, undefined);\r\n    }\r\n\r\n    finishRequest(message: string): void {\r\n        this.loggingService.log(this.componentName, Severity.Information, `${this.componentName}: ${message}`);\r\n    }\r\n\r\n    protected showAlertMessage(message: string): void {\r\n        alert(message);\r\n    }\r\n}\r\n"]}